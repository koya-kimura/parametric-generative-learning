# 教授との面談メモ

## 概要

- 日時：2025年6月11日
- 内容：CNNを用いた画像からの好みスコア予測（image2score）の構築と初期評価、wandbによるロギング、視覚的な可視化による性能確認

---

## 主なトピック

### 1. image2score の初期構築と実装構成

- 入力画像：p5.jsで生成された視覚表現（PNG画像）
- 出力：0〜1の好みスコア（擬似評価関数による生成スコア）
- 実装構成は以下の7ステップに分割して構築：
  1. ライブラリ・パス定義（Pathlib, pandas, torch など）
  2. `ScoreImageDataset` の定義と画像前処理（リサイズ＋正規化）
  3. `SimpleCNNRegressor` による回帰モデルの設計
  4. MSELoss + Adam による損失・最適化の設定
  5. 関数化せず直接ループによる学習実行
  6. wandb によるログ管理と可視化
  7. 学習後の検証データに対する予測値・実測値の可視化（散布図含む）

### 2. データ仕様とファイル命名への対応

- CSVの形式は `id,radiusScale,num,hue,score`
- 画像ファイルは `img_<id>.png` で命名されているため、Dataset側でファイル名を `img_{int(id)}.png` として処理
- score は擬似的に好みを模倣する関数（正規分布＋距離）で生成されている

### 3. 検証用可視化と初期結果

- 検証データの一部を `matplotlib` で表示し、予測スコアと実スコアを画像とともに確認
- 散布図による全体可視化を実施し、対角線とのズレから予測傾向を視覚的に評価
- 完全な精度には至っていないものの、一定の傾向やばらつきの把握が可能になった

---


- scoreの処理はPython上でもよかった...
- 毎回の評価に少しランダム性を持たせてもいいかもしれない
  - scorePreferenceのparams.hueなどに値を加える
- 次は今後になる
- 元のパラメータの再現ができるかもみてみて良い
- ノイズないしパーフェクトでも良かった
  - パラメータからならいけるとして、画像からなので変わったと考えられる
- 混合の場合
  - 2点の距離の近い方？本来の混合正規分布のように足さないようにする
  - そもそも人間がどのように認識してるかみたいな話になる
  - 2つの好みの間の話
  - 嫌いという話もありそう
  - 人間というより、個々人の思考にもよりそう
- 世の中のサジェストモデルとかも、人の趣味思考の分析である
  - 有限個である

- クラス分けができたら中々凄そうである
  - 画像と好みを入力値として、複数のidealPointsを取り出す
  - 教師なし学習のクラスタリングなので、ある程度先行研究ありそう
  - しかし、私はパラメータを知っているので、パラメータに戻してこれる

- 今このスコアまで出せたので、ランキングを作ることができそう
  - 決定木みたいな話になる
  - あなたにとっての中心を教えてをし続ける
  - 相対評価のみがわかる状態(普通の人間)から、最適評価のものを探す
  - 調べてみよう
  - ランキングの時はノイズが必要ないかもしれない、むしろノイズに強い方策になりそう

- 好みを出す時に、、変数同士の関わりもある
  - 完全に人の好みが独立とは限らん
  - 交差している例として2次元にしてみてもいいかも

- 広く人から集めてもダメなのがむずいね
  - ある程度その人の趣味嗜好をガチで知ろうとしているから

- 極地を求めたりするので良さそう、勾配法的な

- 一旦、相対評価のランキングを元にしてどこまでわかりますか、を考えてもらう
  - スコアを予測してランキングにする？
  - **画像を2枚入れて、どちらが勝ったかを出力するモデルを学習させればいい** +1なら右が勝ち、-1なら左が勝ち、0なら引き分け(同一)
    - どのくらい勝った(圧倒的、ギリギリ)かという変数があるので、どうしよう..
    - ロス関数はどうなる？？不正解のものの個数？(+だったら右が勝ち、-だったら左勝ち的な)→クロスエントロピー
      - **2つのセットのデータが3クラスに分かれる**
      - 勾配を求めてとかがどうなるんかもわからんけど、それはどっかに落ちていそう
    - 間違えた個数が離散的なのがむずいって話
      - 今まではスコアがあったよね？

- 目標はスコアを求めることではない！
  - スコアを求めてみた時に近いのは良くはある

- 離散的な相対評価の情報だけでどこまでいけるんや
  - 同じものは絶対に0になるようにしなあかんね

- ノイズは一旦無視して良さそう(データの揺らぎ)

- レコメンドは勝手に学んでもいいかも