# 教授との面談メモ

## 概要

- 日時：2025年6月11日
- 内容：CNNを用いた画像からの好みスコア予測（image2score）の構築と初期評価、wandbによるロギング、視覚的な可視化による性能確認

---

## 主なトピック

### 1. image2scoreの初期構築と実装構成

p5.jsで生成した視覚表現（PNG画像）を入力とし、0〜1の好みスコア（擬似評価関数による生成スコア）を出力するimage2scoreモデルを初期構築した。実装は以下の7ステップに分割して進めた。

1.  ライブラリ・パス定義（Pathlib, pandas, torch など）
2.  `ScoreImageDataset`の定義と画像前処理（リサイズ＋正規化）
3.  `SimpleCNNRegressor`による回帰モデルの設計
4.  MSELoss + Adamによる損失・最適化の設定
5.  関数化せず直接ループによる学習実行
6.  wandbによるログ管理と可視化
7.  学習後の検証データに対する予測値・実測値の可視化（散布図含む）

### 2. データ仕様とファイル命名への対応

データはCSV形式で `id,radiusScale,num,hue,score` のカラムを持ち、画像ファイルは `img_<id>.png` で命名されている。Dataset側でファイル名を `img_{int(id)}.png` として処理するよう対応した。scoreは擬似的に好みを模倣する関数（正規分布＋距離）で生成されている。

### 3. 検証用可視化と初期結果

検証データの一部を`matplotlib`で表示し、予測スコアと実スコアを画像とともに確認した。散布図による全体可視化も実施し、対角線とのズレから予測傾向を視覚的に評価した。完全な精度には至らないものの、一定の傾向やばらつきの把握が可能となった。

---

## 議論内容（ディスカッションログ）2025年6月11日

### 1. スコア予測に関する検討

-   scoreの処理はPython上でも実装可能であった。
-   毎回の評価にわずかなランダム性を持たせることで、モデルの汎化性能向上が期待できる。具体的には、scorePreferenceのparams.hueなどに値を加える方法が考えられる。
-   元のパラメータの再現性についても検証を進めることが望ましい。
-   ノイズがない、あるいは完璧なデータを用いた学習も検討対象となる。パラメータからの予測が可能である点を踏まえ、画像からの予測における特性をさらに分析する必要がある。

### 2. 混合分布モデルと人間の嗜好

-   混合分布モデルとして、2つの基準点との距離の近い方を用いるアプローチが議論された。本来の混合正規分布のように足し合わせない形式も考慮される。
-   人間の好みは複雑であり、「嫌い」という概念もモデルに含めることで、より多様な嗜好を表現できる可能性がある。
-   世の中のレコメンドモデルは個人の趣味嗜好の分析に基づいている。
-   画像と好みを入力値として、複数のidealPointsを取り出す「クラス分け」の実現は高度な課題である。教師なし学習のクラスタリングには先行研究が存在するが、本研究ではパラメータ情報があるため、その情報を活用してパラメータに戻して分析することが可能である。

### 3. ランキング学習への展開

-   現在のスコア予測モデルからランキングを作成することが可能である。決定木のような手法も有効な選択肢となり得る。
-   相対評価のみが分かる状態から、最適な評価を持つものを探索するアプローチが考えられる。
-   **画像を2枚入力し、どちらが勝ったかを出力するモデルを学習させる**という提案があった。
    -   出力は+1（右が勝ち）、-1（左が勝ち）、0（引き分け）の3クラス分類となる。
    -   損失関数にはクロスエントロピーが適していると考えられる。
    -   勾配の計算や、離散的な不正解の個数に基づく評価の難しさについて議論があった。
-   本研究の目標はスコアを求めることではなく、最終的にランキングを得ることである。スコア予測はその途中段階として有効である。
-   離散的な相対評価の情報だけでどこまでランキングを構築できるか、その限界と可能性を探る。
-   同一のものは必ず0（引き分け）になるように設計する必要がある。
-   ノイズ（データの揺らぎ）は一旦無視してモデル構築を進めることが適切であるとされた。

### 4. その他の検討事項

-   好みは変数同士の複雑な関わりを持つ可能性があり、完全に独立ではない。交差する例として2次元のケースを試行することも有効である。
-   レコメンドモデルは自己学習により好みを獲得できる可能性がある。
-   極値探索や勾配法的なアプローチも有効である。