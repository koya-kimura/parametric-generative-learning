# 教授との面談メモ

## 概要

- 日時：2025年5月21日 13:10-
- 内容：CNNなどを用いて画像からパラメータを取り出す

---

## 主なトピック

### 1. 前回からの画像生成システムの改善要素

- csvを読み込むというシステムを追加
- 画像を保存するか否かを選択できる機能を追加

### 2. CNNを用いた画像パラメータ抽出

- `dipCount` 単体を予測するモデル（`image2dipcount_single.ipynb`）を完成。
  - 画像と `dipCount` のペアを使った回帰モデルを学習。
  - 損失関数には `MSELoss`、最適化手法は `Adam`。
  - 学習後はロスカーブと画像上の予測/真値を比較する可視化を行った。
- 複数パラメータに対応する拡張モデル（`image2params_multi.ipynb`）を新たに構築。
  - 出力を `[dipCount, hue_cos, hue_sin]` の3次元ベクトルとする。
  - `hue` はラジアンに変換して `(cos, sin)` 表現にし、周期性に対応。
- `MultiParamDataset` を定義し、`dipCount`と`hue`の変換をラベルとして返す構成に変更。
- `MultiParamCNN` では、最終出力層を3ユニットとし、マルチ出力に対応。
- `tqdm` を用いて学習進捗を視覚化し、`torchinfo.summary()` でモデル構造を確認。
- Mac (M1/M2) への対応として `cuda` / `mps` / `cpu` の自動判定機構を導入。
- 検証結果の可視化においては、予測された `hue` を `arctan2` により角度に戻し、真値と比較。
- Stepごとにテスト＆可視化ブロックを追加することで、進行の理解とデバッグが容易に。

---

### 3. 今後の検討事項

- `hue` の角度誤差（周期的距離）を数値評価する指標の導入
- 他パラメータ（`circleCount`, `asp`, `startAngle` など）を含めた出力次元の拡張
- `torch.save` / `torch.load` による学習済みモデルの保存と推論再利用
- モデル予測の分布（散布図、誤差ヒストグラムなど）を使った性能評価の可視化